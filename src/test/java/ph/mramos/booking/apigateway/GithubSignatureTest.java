package ph.mramos.booking.apigateway;

import java.nio.charset.StandardCharsets;

import org.junit.jupiter.api.Test;

import com.google.common.hash.Hashing;

public class GithubSignatureTest {

	@Test
	public void testGithubSignature() {
		String rawBody = "{\"ref\":\"refs/heads/master\",\"before\":\"d24b92f926cb899fa0856aa3955bba48f9913f3e\",\"after\":\"41ad85ded4808f4328f2f39128435c072742a85c\",\"repository\":{\"id\":510231957,\"node_id\":\"R_kgDOHmmFlQ\",\"name\":\"config-repo\",\"full_name\":\"maxramos/config-repo\",\"private\":false,\"owner\":{\"name\":\"maxramos\",\"email\":\"max.a.ramos@gmail.com\",\"login\":\"maxramos\",\"id\":6870651,\"node_id\":\"MDQ6VXNlcjY4NzA2NTE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/6870651?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/maxramos\",\"html_url\":\"https://github.com/maxramos\",\"followers_url\":\"https://api.github.com/users/maxramos/followers\",\"following_url\":\"https://api.github.com/users/maxramos/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/maxramos/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/maxramos/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/maxramos/subscriptions\",\"organizations_url\":\"https://api.github.com/users/maxramos/orgs\",\"repos_url\":\"https://api.github.com/users/maxramos/repos\",\"events_url\":\"https://api.github.com/users/maxramos/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/maxramos/received_events\",\"type\":\"User\",\"site_admin\":false},\"html_url\":\"https://github.com/maxramos/config-repo\",\"description\":null,\"fork\":false,\"url\":\"https://github.com/maxramos/config-repo\",\"forks_url\":\"https://api.github.com/repos/maxramos/config-repo/forks\",\"keys_url\":\"https://api.github.com/repos/maxramos/config-repo/keys{/key_id}\",\"collaborators_url\":\"https://api.github.com/repos/maxramos/config-repo/collaborators{/collaborator}\",\"teams_url\":\"https://api.github.com/repos/maxramos/config-repo/teams\",\"hooks_url\":\"https://api.github.com/repos/maxramos/config-repo/hooks\",\"issue_events_url\":\"https://api.github.com/repos/maxramos/config-repo/issues/events{/number}\",\"events_url\":\"https://api.github.com/repos/maxramos/config-repo/events\",\"assignees_url\":\"https://api.github.com/repos/maxramos/config-repo/assignees{/user}\",\"branches_url\":\"https://api.github.com/repos/maxramos/config-repo/branches{/branch}\",\"tags_url\":\"https://api.github.com/repos/maxramos/config-repo/tags\",\"blobs_url\":\"https://api.github.com/repos/maxramos/config-repo/git/blobs{/sha}\",\"git_tags_url\":\"https://api.github.com/repos/maxramos/config-repo/git/tags{/sha}\",\"git_refs_url\":\"https://api.github.com/repos/maxramos/config-repo/git/refs{/sha}\",\"trees_url\":\"https://api.github.com/repos/maxramos/config-repo/git/trees{/sha}\",\"statuses_url\":\"https://api.github.com/repos/maxramos/config-repo/statuses/{sha}\",\"languages_url\":\"https://api.github.com/repos/maxramos/config-repo/languages\",\"stargazers_url\":\"https://api.github.com/repos/maxramos/config-repo/stargazers\",\"contributors_url\":\"https://api.github.com/repos/maxramos/config-repo/contributors\",\"subscribers_url\":\"https://api.github.com/repos/maxramos/config-repo/subscribers\",\"subscription_url\":\"https://api.github.com/repos/maxramos/config-repo/subscription\",\"commits_url\":\"https://api.github.com/repos/maxramos/config-repo/commits{/sha}\",\"git_commits_url\":\"https://api.github.com/repos/maxramos/config-repo/git/commits{/sha}\",\"comments_url\":\"https://api.github.com/repos/maxramos/config-repo/comments{/number}\",\"issue_comment_url\":\"https://api.github.com/repos/maxramos/config-repo/issues/comments{/number}\",\"contents_url\":\"https://api.github.com/repos/maxramos/config-repo/contents/{+path}\",\"compare_url\":\"https://api.github.com/repos/maxramos/config-repo/compare/{base}...{head}\",\"merges_url\":\"https://api.github.com/repos/maxramos/config-repo/merges\",\"archive_url\":\"https://api.github.com/repos/maxramos/config-repo/{archive_format}{/ref}\",\"downloads_url\":\"https://api.github.com/repos/maxramos/config-repo/downloads\",\"issues_url\":\"https://api.github.com/repos/maxramos/config-repo/issues{/number}\",\"pulls_url\":\"https://api.github.com/repos/maxramos/config-repo/pulls{/number}\",\"milestones_url\":\"https://api.github.com/repos/maxramos/config-repo/milestones{/number}\",\"notifications_url\":\"https://api.github.com/repos/maxramos/config-repo/notifications{?since,all,participating}\",\"labels_url\":\"https://api.github.com/repos/maxramos/config-repo/labels{/name}\",\"releases_url\":\"https://api.github.com/repos/maxramos/config-repo/releases{/id}\",\"deployments_url\":\"https://api.github.com/repos/maxramos/config-repo/deployments\",\"created_at\":1656914579,\"updated_at\":\"2022-07-04T06:02:59Z\",\"pushed_at\":1657183248,\"git_url\":\"git://github.com/maxramos/config-repo.git\",\"ssh_url\":\"git@github.com:maxramos/config-repo.git\",\"clone_url\":\"https://github.com/maxramos/config-repo.git\",\"svn_url\":\"https://github.com/maxramos/config-repo\",\"homepage\":null,\"size\":9,\"stargazers_count\":0,\"watchers_count\":0,\"language\":null,\"has_issues\":true,\"has_projects\":true,\"has_downloads\":true,\"has_wiki\":true,\"has_pages\":false,\"forks_count\":0,\"mirror_url\":null,\"archived\":false,\"disabled\":false,\"open_issues_count\":0,\"license\":null,\"allow_forking\":true,\"is_template\":false,\"web_commit_signoff_required\":false,\"topics\":[],\"visibility\":\"public\",\"forks\":0,\"open_issues\":0,\"watchers\":0,\"default_branch\":\"master\",\"stargazers\":0,\"master_branch\":\"master\"},\"pusher\":{\"name\":\"maxramos\",\"email\":\"max.a.ramos@gmail.com\"},\"sender\":{\"login\":\"maxramos\",\"id\":6870651,\"node_id\":\"MDQ6VXNlcjY4NzA2NTE=\",\"avatar_url\":\"https://avatars.githubusercontent.com/u/6870651?v=4\",\"gravatar_id\":\"\",\"url\":\"https://api.github.com/users/maxramos\",\"html_url\":\"https://github.com/maxramos\",\"followers_url\":\"https://api.github.com/users/maxramos/followers\",\"following_url\":\"https://api.github.com/users/maxramos/following{/other_user}\",\"gists_url\":\"https://api.github.com/users/maxramos/gists{/gist_id}\",\"starred_url\":\"https://api.github.com/users/maxramos/starred{/owner}{/repo}\",\"subscriptions_url\":\"https://api.github.com/users/maxramos/subscriptions\",\"organizations_url\":\"https://api.github.com/users/maxramos/orgs\",\"repos_url\":\"https://api.github.com/users/maxramos/repos\",\"events_url\":\"https://api.github.com/users/maxramos/events{/privacy}\",\"received_events_url\":\"https://api.github.com/users/maxramos/received_events\",\"type\":\"User\",\"site_admin\":false},\"created\":false,\"deleted\":false,\"forced\":false,\"base_ref\":null,\"compare\":\"https://github.com/maxramos/config-repo/compare/d24b92f926cb...41ad85ded480\",\"commits\":[{\"id\":\"41ad85ded4808f4328f2f39128435c072742a85c\",\"tree_id\":\"3ffe215e478029a7b6f9775fd1ab6d59b1dee245\",\"distinct\":true,\"message\":\"Updated config.\",\"timestamp\":\"2022-07-07T16:40:45+08:00\",\"url\":\"https://github.com/maxramos/config-repo/commit/41ad85ded4808f4328f2f39128435c072742a85c\",\"author\":{\"name\":\"Max\",\"email\":\"Max@MAX-LENOVO\"},\"committer\":{\"name\":\"Max\",\"email\":\"Max@MAX-LENOVO\"},\"added\":[],\"removed\":[],\"modified\":[\"booking-app-dev.properties\"]}],\"head_commit\":{\"id\":\"41ad85ded4808f4328f2f39128435c072742a85c\",\"tree_id\":\"3ffe215e478029a7b6f9775fd1ab6d59b1dee245\",\"distinct\":true,\"message\":\"Updated config.\",\"timestamp\":\"2022-07-07T16:40:45+08:00\",\"url\":\"https://github.com/maxramos/config-repo/commit/41ad85ded4808f4328f2f39128435c072742a85c\",\"author\":{\"name\":\"Max\",\"email\":\"Max@MAX-LENOVO\"},\"committer\":{\"name\":\"Max\",\"email\":\"Max@MAX-LENOVO\"},\"added\":[],\"removed\":[],\"modified\":[\"booking-app-dev.properties\"]}}";
		System.out.println("Raw Body:");
		System.out.println("'" + rawBody + "'");

		String hashedBody = Hashing.hmacSha256("secret-key".getBytes(StandardCharsets.UTF_8)) // Replace with actual secret key.
				.hashString(rawBody, StandardCharsets.UTF_8)
				.toString();
		System.out.println("Hashed Body:");
		System.out.println(hashedBody);
	}

}
